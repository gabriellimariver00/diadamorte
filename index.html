<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1,user-scalable=no" />
<title>Descubra o Dia da Sua Morte</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Unbounded:wght@700&family=Playfair+Display&display=swap');
  /* Reset básico */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body, html {
    height: 100%;
    background: #000 url('https://img.freepik.com/fotos-premium/arvore-preta-seca-sem-folhas-com-ceu-vermelho-sangue-assustador-fundo-de-natureza-de-arvore-de-horror-assustador-para-o-halloween_696486-50.jpg') no-repeat center center fixed;
    background-size: cover;
    color: #eee;
    font-family: 'Playfair Display', serif;
    overflow-x: hidden;
  }
  /* Overlay preto com transparência para escurecer */
  body::before {
    content: "";
    position: fixed;
    top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.85);
    z-index: 0;
  }
  #app {
    position: relative;
    z-index: 10;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .fade-slide {
    animation: fadeSlideIn 0.6s ease forwards;
  }
  @keyframes fadeSlideIn {
    from {opacity:0; transform: translateX(50px);}
    to {opacity:1; transform: translateX(0);}
  }
  .screen {
    width: 100%;
    max-width: 480px;
    background: rgba(20,20,20,0.75);
    border-radius: 15px;
    padding: 25px 30px 40px 30px;
    box-shadow: 0 0 15px 3px rgba(0,0,0,0.8);
    user-select: none;
  }
  h1, h2 {
    font-family: 'Unbounded', cursive;
    margin-bottom: 25px;
    text-align: center;
    color: #f0f0f0;
    text-shadow: 0 0 12px #880000;
  }
  p {
    margin-bottom: 15px;
    font-size: 1.1rem;
    line-height: 1.5;
  }
  .question-text {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 20px;
    text-align: center;
    text-shadow: 0 0 10px #cc0000;
  }
  .btn-group {
    display: flex;
    justify-content: space-between;
  }
  button {
    background: linear-gradient(135deg, #7a0000, #b30000);
    border: none;
    padding: 14px 22px;
    border-radius: 12px;
    color: #f8f8f8;
    font-weight: 700;
    font-family: 'Unbounded', cursive;
    font-size: 1.1rem;
    cursor: pointer;
    flex-basis: 30%;
    box-shadow: 0 0 8px #aa0000;
    transition: background 0.3s ease;
  }
  button:hover {
    background: linear-gradient(135deg, #b30000, #7a0000);
  }
  input[type="text"], input[type="date"] {
    width: 100%;
    padding: 14px 15px;
    font-size: 1.1rem;
    font-family: 'Playfair Display', serif;
    border-radius: 10px;
    border: none;
    margin-bottom: 25px;
    box-shadow: inset 0 0 6px #660000;
    background: rgba(40, 0, 0, 0.8);
    color: #f0f0f0;
    text-align: center;
  }
  input[type="date"]::-webkit-inner-spin-button,
  input[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(1);
  }
  input[type="date"]::placeholder {
    color: #eee;
  }
  /* Imagem da morte no topo e resultado */
  #grim-reaper {
    width: 110px;
    margin: 0 auto 30px auto;
    display: block;
    filter: drop-shadow(0 0 10px #bb0000);
  }
  /* Resultado estilizado */
  #result-text {
    font-size: 1.25rem;
    text-align: center;
    color: #ffdddd;
    text-shadow: 0 0 12px #bb0000;
  }
  /* Responsividade */
  @media (max-width: 480px) {
    .btn-group {
      flex-direction: column;
      gap: 15px;
    }
    button {
      flex-basis: 100%;
      font-size: 1.3rem;
      padding: 16px 0;
    }
    #grim-reaper {
      width: 90px;
      margin-bottom: 25px;
    }
  }
</style>
</head>
<body>
<audio id="ambient-sound" loop autoplay muted playsinline>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_00a3e8f6ef.mp3?filename=dark-fantasy-ambient-12586.mp3" type="audio/mpeg" />
  Seu navegador não suporta áudio.
</audio>
<div id="app" class="fade-slide">
  <!-- Tela Inicial -->
  <div id="screen-start" class="screen">
    <img id="grim-reaper" src="https://segredosdomundo.r7.com/wp-content/uploads/2021/12/10-anjos-da-morte-mais-conhecidos-na-biblia-e-na-mitologia-e1639504697683.jpg" alt="Figura da Morte com foice" />
    <h1>Descubra o Dia da Sua Morte</h1>
    <p style="text-align:center; font-size:1.1rem; margin-bottom:25px; color:#ff6666; text-shadow:0 0 8px #ff0000;">
      Será que você sabe quando vai morrer? Responda as perguntas e descubra seu destino final...
    </p>
    <button id="start-btn">Começar</button>
  </div>
  <!-- Perguntas -->
  <div id="screen-questions" class="screen" style="display:none;">
    <div id="question-container">
      <p class="question-text" id="question-text"></p>
      <div class="btn-group" id="answers"></div>
    </div>
  </div>
  <!-- Resultado -->
  <div id="screen-result" class="screen" style="display:none;">
    <img id="grim-reaper-result" src="https://segredosdomundo.r7.com/wp-content/uploads/2021/12/10-anjos-da-morte-mais-conhecidos-na-biblia-e-na-mitologia-e1639504697683.jpg" alt="Figura da Morte com foice" style="width: 130px; display:block; margin: 0 auto 30px auto; filter: drop-shadow(0 0 12px #bb0000);" />
    <h2>Seu Fim Está Marcado</h2>
    <p id="result-text"></p>
  </div>
</div>
<script>
(() => {
  const audio = document.getElementById('ambient-sound');
  audio.volume = 0.12; // Volume baixo (12%)
  audio.muted = false;

  const questions = [
    {
      text: "Você fuma?",
      answers: ["Sim", "Não", "Às vezes"]
    },
    {
      text: "Você pratica exercícios físicos regularmente?",
      answers: ["Sim", "Não", "Às vezes"]
    },
    {
      text: "Você já teve alguma doença grave (ex: diabetes, pressão alta)?",
      answers: ["Sim", "Não"]
    },
    {
      text: "Você consome bebidas alcoólicas?",
      answers: ["Sim", "Não", "Às vezes"]
    },
    {
      text: "Você tem histórico familiar de doenças cardíacas?",
      answers: ["Sim", "Não"]
    },
    {
      text: "Qual seu nome?",
      answers: null,
      inputType: "text",
      inputId: "nameInput",
      inputPlaceholder: "Digite seu nome aqui"
    },
    {
      text: "Qual sua data de nascimento?",
      answers: null,
      inputType: "text",
      inputId: "birthDateInput",
      inputPlaceholder: "Digite sua data de nascimento aqui (dd/mm/aaaa)"
    }
  ];

  const deathCauses = [
    "parada cardíaca inesperada",
    "acidente de carro fatal",
    "infarto fulminante",
    "derrame cerebral",
    "complicações de uma doença crônica",
    "queda grave",
    "insuficiência respiratória",
    "envenenamento acidental",
    "ataque de apneia durante o sono"
  ];

  let currentQuestion = 0;
  let userData = {};
  const app = document.getElementById('app');
  const screenStart = document.getElementById('screen-start');
  const screenQuestions = document.getElementById('screen-questions');
  const screenResult = document.getElementById('screen-result');
  const questionText = document.getElementById('question-text');
  const answersContainer = document.getElementById('answers');
  const resultText = document.getElementById('result-text');

  const grimReaperStart = document.getElementById('grim-reaper');
  const grimReaperResult = document.getElementById('grim-reaper-result');

  // Função para formatar a data dd/mm/aaaa com barras automáticas
  function formatDateInput(value) {
    let v = value.replace(/\D/g, '');
    if (v.length > 2 && v.length <= 4) v = v.slice(0,2) + '/' + v.slice(2);
    else if (v.length > 4) v = v.slice(0,2) + '/' + v.slice(2,4) + '/' + v.slice(4,8);
    return v;
  }

  // Mostra pergunta atual
  function showQuestion(index) {
    const q = questions[index];
    questionText.textContent = q.text;
    answersContainer.innerHTML = '';
    if (q.answers) {
      q.answers.forEach(ans => {
        const btn = document.createElement('button');
        btn.textContent = ans;
        btn.onclick = () => {
          userData[q.text] = ans;
          nextQuestion();
        };
        answersContainer.appendChild(btn);
      });
      // Espaçamento dos botões: 3 botões -> espaço uniforme, 2 botões -> meio e direita
      if (q.answers.length === 3) {
        answersContainer.style.justifyContent = 'space-between';
      } else {
        answersContainer.style.justifyContent = 'flex-start';
        // Ajusta espaçamento se só 2 botões
        if (answersContainer.children.length === 2) {
          answersContainer.children[0].style.marginRight = '10px';
        }
      }
    } else if (q.inputType === 'text') {
      const input = document.createElement('input');
      input.type = 'text';
      input.id = q.inputId;
      input.placeholder = q.inputPlaceholder;
      input.autocomplete = 'off';
      if(q.inputId === "birthDateInput"){
        input.inputMode = "numeric";
        input.maxLength = 10;
        input.oninput = e => {
          e.target.value = formatDateInput(e.target.value);
        }
      }
      answersContainer.appendChild(input);
      const btnNext = document.createElement('button');
      btnNext.textContent = "Próximo";
      btnNext.onclick = () => {
        const val = document.getElementById(q.inputId).value.trim();
        if(val.length === 0){
          alert("Por favor, preencha o campo.");
          return;
        }
        if(q.inputId === "birthDateInput" && !/^\d{2}\/\d{2}\/\d{4}$/.test(val)){
          alert("Digite a data no formato dd/mm/aaaa.");
          return;
        }
        if(q.inputId === "nameInput" && val.length < 2){
          alert("Digite um nome válido.");
          return;
        }
        userData[q.text] = val;
        nextQuestion();
      };
      answersContainer.appendChild(btnNext);
      // Centraliza input e botão
      input.style.marginBottom = '15px';
      btnNext.style.width = '100%';
    }
  }

  // Próxima pergunta ou mostra resultado
  function nextQuestion() {
    currentQuestion++;
    if(currentQuestion < questions.length){
      showQuestion(currentQuestion);
    } else {
      showResult();
    }
  }

  // Calcula a idade e data da morte aleatoriamente entre 1 e 15 anos a partir da idade atual
  function calculateDeathDate(birthDate) {
    // birthDate no formato dd/mm/aaaa
    const parts = birthDate.split('/');
    const day = parseInt(parts[0],10);
    const month = parseInt(parts[1],10) -1; // mês começa do zero
    const year = parseInt(parts[2],10);
    const birth = new Date(year, month, day);
    const now = new Date();

    let ageNow = now.getFullYear() - birth.getFullYear();
    if(now.getMonth() < month || (now.getMonth() === month && now.getDate() < day)){
      ageNow--;
    }
    // Morre entre 1 e 15 anos a partir da idade atual
    const yearsToDeath = Math.floor(Math.random() * 15) + 1;
    const deathYear = birth.getFullYear() + ageNow + yearsToDeath;
    const deathDate = new Date(deathYear, month, day);

    return { deathDate, ageAtDeath: ageNow + yearsToDeath };
  }

  // Gera resultado
  function showResult() {
    screenQuestions.style.display = 'none';
    screenResult.style.display = 'block';

    // Causa da morte aleatória
    const cause = deathCauses[Math.floor(Math.random() * deathCauses.length)];
    const { deathDate, ageAtDeath } = calculateDeathDate(userData["Qual sua data de nascimento?"]);

    // Cidades próximas
    const cidades = ["Jaguaribe", "Jaguaribara", "Limoeiro", "Itaiçaba", "Aracati", "Morada Nova"];
    const city = cidades[Math.floor(Math.random() * cidades.length)];

    resultText.innerHTML = `${userData["Qual seu nome?"]}, seu fim acontecerá exatamente assim:<br><br>
    Você terá <strong>${cause}</strong>.<br>
    Você morrerá no dia <strong>${deathDate.toLocaleDateString('pt-BR')}</strong> aos <strong>${ageAtDeath}</strong> anos.<br>
    O local será na cidade de <strong>${city}</strong>.`;

    // Bloqueio para não repetir nome (sessionStorage)
    sessionStorage.setItem('visitedName', userData["Qual seu nome?"].toLowerCase());
  }

  // Verifica se já visitou com o mesmo nome
  function checkVisitedName() {
    const visited = sessionStorage.getItem('visitedName');
    if(visited && visited === userData["Qual seu nome?"].toLowerCase()){
      alert("Você já consultou com esse nome. Use outro nome para consultar novamente.");
      location.reload();
    }
  }

  // Começa o app
  document.getElementById('start-btn').addEventListener('click', () => {
    screenStart.style.display = 'none';
    screenQuestions.style.display = 'block';
    showQuestion(0);
  });

  // Monitorar input do nome para checar se já consultou
  document.addEventListener('click', () => {
    if(userData["Qual seu nome?"]){
      checkVisitedName();
    }
  });
})();
</script>
</body>
</html>
